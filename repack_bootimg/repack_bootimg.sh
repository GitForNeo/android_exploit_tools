#!/bin/bash

# sudo apt-get install abootimg

# after build kernel

if [ ! -n "$1" ]
then
    echo "!!!error!!!"; echo "you should input zImage-dtb path, like '/arch/arm/boot/zImage-dtb'"
    exit
fi

abootimg -x boot.img

sed -i '/bootsize =/d' bootimg.cfg

abootimg --create newboot.img -f bootimg.cfg -k $1 -r initrd.img

rm bootimg.cfg
rm initrd.img
rm zImage

echo "ok! 'newboot.img'"